import torch
from model import ResNet9

# Path to the model file
disease_model_path = "models/plant_disease_model.pth"

# Initialize the model with the correct parameters
disease_model = ResNet9(num_channels=3, num_classes=len(disease_classes))

# Load the saved weights
try:
    checkpoint = torch.load(disease_model_path, map_location=torch.device("cpu"))
    disease_model.load_state_dict(checkpoint)
    disease_model.eval()
    print("Model loaded successfully.")
except Exception as e:
    print(f"Error loading model: {e}")
